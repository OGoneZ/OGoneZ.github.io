

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/logo.png">
  <link rel="icon" href="/img/logo.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#191E23">
  <meta name="author" content="baoduozhu">
  <meta name="keywords" content="">
  
    <meta name="description" content="1 ç¥ç»ç½‘ç»œçš„æ„æˆ 12345import numpy as npimport matplotlib.pyplot as pltimport seaborn as snssns.set_theme() äººå·¥ç¥ç»ç½‘ç»œï¼ˆArtificial Neural Networkï¼ŒANNï¼‰ç®€ç§°ç¥ç»ç½‘ç»œï¼ˆNNï¼‰ï¼Œæ˜¯ä¸€ç§æ¨¡ä»¿ç”Ÿç‰©ç¥ç»ç½‘ç»œç»“æ„å’ŒåŠŸèƒ½çš„è®¡ç®—æ¨¡å‹ï¼Œç”±å¤šä¸ªç¥ç»å…ƒæ„æˆã€‚ æ¯ä¸ªç¥ç»å…ƒç±»ä¼¼æœºå™¨å­¦ä¹ ä¸­çš„æ„ŸçŸ¥">
<meta property="og:type" content="article">
<meta property="og:title" content="02_ç¥ç»ç½‘ç»œåŸºç¡€">
<meta property="og:url" content="http://example.com/2024/08/05/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91/05%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/02_%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="æœ±å®é“çš„æŠ€æœ¯ä¸“æ ">
<meta property="og:description" content="1 ç¥ç»ç½‘ç»œçš„æ„æˆ 12345import numpy as npimport matplotlib.pyplot as pltimport seaborn as snssns.set_theme() äººå·¥ç¥ç»ç½‘ç»œï¼ˆArtificial Neural Networkï¼ŒANNï¼‰ç®€ç§°ç¥ç»ç½‘ç»œï¼ˆNNï¼‰ï¼Œæ˜¯ä¸€ç§æ¨¡ä»¿ç”Ÿç‰©ç¥ç»ç½‘ç»œç»“æ„å’ŒåŠŸèƒ½çš„è®¡ç®—æ¨¡å‹ï¼Œç”±å¤šä¸ªç¥ç»å…ƒæ„æˆã€‚ æ¯ä¸ªç¥ç»å…ƒç±»ä¼¼æœºå™¨å­¦ä¹ ä¸­çš„æ„ŸçŸ¥">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.zhubaoduo.com/dl.jpg">
<meta property="article:published_time" content="2024-08-04T16:00:00.000Z">
<meta property="article:modified_time" content="2025-12-05T12:10:07.866Z">
<meta property="article:author" content="baoduozhu">
<meta property="article:tag" content="æ·±åº¦å­¦ä¹ ">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://img.zhubaoduo.com/dl.jpg">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>02_ç¥ç»ç½‘ç»œåŸºç¡€ - æœ±å®é“çš„æŠ€æœ¯ä¸“æ </title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Zhubd</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://img.zhubaoduo.com/j35.gif') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="02_ç¥ç»ç½‘ç»œåŸºç¡€"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-08-05 00:00" pubdate>
          2024å¹´8æœˆ5æ—¥ å‡Œæ™¨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          6.2k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          79 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar category-bar" style="margin-right: -1rem">
    





<div class="category-list">
  
  
    
    
    
    <div class="category row nomargin-x">
      <a class="category-item 
          list-group-item category-item-action col-10 col-md-11 col-xm-11" title="æ·±åº¦å­¦ä¹ "
        id="heading-8c5f70f85d5a691a5f1dc7be5473736b" role="tab" data-toggle="collapse" href="#collapse-8c5f70f85d5a691a5f1dc7be5473736b"
        aria-expanded="true"
      >
        æ·±åº¦å­¦ä¹ 
        <span class="list-group-count">(5)</span>
        <i class="iconfont icon-arrowright"></i>
      </a>
      
      <div class="category-collapse collapse show" id="collapse-8c5f70f85d5a691a5f1dc7be5473736b"
           role="tabpanel" aria-labelledby="heading-8c5f70f85d5a691a5f1dc7be5473736b">
        
        
          
  <div class="category-post-list">
    
    
      
      
        <a href="/2024/08/03/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91/05%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/01_%E5%BC%A0%E9%87%8F%E5%92%8C%E8%87%AA%E5%8A%A8%E5%BE%AE%E5%88%86/" title="01_å¼ é‡å’Œè‡ªåŠ¨å¾®åˆ†"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">01_å¼ é‡å’Œè‡ªåŠ¨å¾®åˆ†</span>
        </a>
      
    
      
      
        <a href="/2024/08/05/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91/05%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/02_%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/" title="02_ç¥ç»ç½‘ç»œåŸºç¡€"
           class="list-group-item list-group-item-action
           active">
          <span class="category-post">02_ç¥ç»ç½‘ç»œåŸºç¡€</span>
        </a>
      
    
      
      
        <a href="/2024/08/07/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91/05%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/03_%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0%E5%92%8C%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95/" title="03_æŸå¤±å‡½æ•°å’Œä¼˜åŒ–ç®—æ³•"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">03_æŸå¤±å‡½æ•°å’Œä¼˜åŒ–ç®—æ³•</span>
        </a>
      
    
      
      
        <a href="/2024/08/09/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91/05%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/04_CNN%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" title="04_CNNå·ç§¯ç¥ç»ç½‘ç»œ"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">04_CNNå·ç§¯ç¥ç»ç½‘ç»œ</span>
        </a>
      
    
      
      
        <a href="/2024/08/10/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91/05%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/05_RNN%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" title="05_RNNå¾ªç¯ç¥ç»ç½‘ç»œ"
           class="list-group-item list-group-item-action
           ">
          <span class="category-post">05_RNNå¾ªç¯ç¥ç»ç½‘ç»œ</span>
        </a>
      
    
  </div>

        
      </div>
    </div>
  
</div>


  </aside>


    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">02_ç¥ç»ç½‘ç»œåŸºç¡€</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="ç¥ç»ç½‘ç»œçš„æ„æˆ">1 ç¥ç»ç½‘ç»œçš„æ„æˆ</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<br><br>sns.set_theme()<br></code></pre></td></tr></table></figure>
<p>äººå·¥ç¥ç»ç½‘ç»œï¼ˆArtificial Neural
Networkï¼ŒANNï¼‰ç®€ç§°ç¥ç»ç½‘ç»œï¼ˆNNï¼‰ï¼Œæ˜¯ä¸€ç§æ¨¡ä»¿ç”Ÿç‰©ç¥ç»ç½‘ç»œç»“æ„å’ŒåŠŸèƒ½çš„è®¡ç®—æ¨¡å‹ï¼Œç”±å¤šä¸ªç¥ç»å…ƒæ„æˆã€‚</p>
<p>æ¯ä¸ªç¥ç»å…ƒç±»ä¼¼æœºå™¨å­¦ä¹ ä¸­çš„æ„ŸçŸ¥æœºï¼Œæ¯ä¸ªè¾“å…¥æœ‰ä¸åŒçš„æƒé‡ï¼ŒåŠ æƒæ±‚å’Œç»è¿‡<strong>æ¿€æ´»å‡½æ•°</strong>å¾—åˆ°è¾“å‡ºã€‚</p>
<p><img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-neuron.png" srcset="/img/loading.gif" lazyload /></p>
<p>ä½¿ç”¨å¤šä¸ªç¥ç»å…ƒæ„æˆç½‘ç»œï¼Œç›¸é‚»å±‚ä¹‹é—´ç›¸äº’è¿æ¥ï¼Œæ¯å±‚ä¹‹é—´é€šè¿‡æ¿€æ´»å‡½æ•°è¿›è¡Œéçº¿æ€§æ˜ å°„ï¼Œæœ€ç»ˆå¾—åˆ°ç»“æœã€‚åŒä¸€å±‚çš„å¤šä¸ªç¥ç»å…ƒå¯ä»¥çœ‹ä½œæ˜¯å¹¶è¡Œè®¡ç®—å¤„ç†ç›¸åŒçš„è¾“å…¥æ•°æ®ï¼Œå­¦ä¹ è¾“å…¥æ•°æ®çš„ä¸åŒç‰¹å¾ã€‚æ¯ä¸ªç¥ç»å…ƒå¯èƒ½ä¼šå…³æ³¨è¾“å…¥æ•°æ®ä¸­çš„ä¸åŒéƒ¨åˆ†ï¼Œä»è€Œæ•æ‰åˆ°æ•°æ®çš„ä¸åŒå±æ€§ã€‚ç±»ä¼¼é›†æˆå­¦ä¹ çš„æ€æƒ³ï¼Œå¤šä¸ªç¥ç»å…ƒç»„åˆåœ¨ä¸€èµ·ï¼Œå¯ä»¥å¤„ç†æ›´å¤æ‚çš„æ•°æ®ã€‚</p>
<p>æ¯ä¸€å±‚ç¥ç»ç½‘ç»œï¼ˆå…¨è¿æ¥å±‚ï¼‰æœ¬è´¨éƒ½æ˜¯ä¸€æ¬¡çº¿æ€§å˜æ¢åŠ ä¸€æ¬¡éçº¿æ€§æ˜ å°„ï¼Œç±»ä¼¼é€»è¾‘å›å½’+æ¿€æ´»å‡½æ•°ã€‚ç¥ç»ç½‘ç»œæ­£æ˜¯é è¿™ç§â€œçº¿æ€§å˜æ¢
+
éçº¿æ€§æ˜ å°„â€çš„é‡å¤å †å ï¼Œæ‰èƒ½ä»ç®€å•çš„çº¿æ€§æ¨¡å‹æ‰©å±•æˆå¯ä»¥é€¼è¿‘ä»»æ„å‡½æ•°çš„å¤æ‚ç»“æ„ã€‚</p>
<p><img src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-nn.png" srcset="/img/loading.gif" lazyload /></p>
<ul>
<li><strong>è¾“å…¥å±‚ï¼ˆInput Layerï¼‰</strong>:
æ¯ä¸ªè¾“å…¥ç‰¹å¾å¯¹åº”ä¸€ä¸ªç¥ç»å…ƒ</li>
<li><strong>è¾“å‡ºå±‚ï¼ˆOutput Layerï¼‰</strong>:
è¾“å‡ºå±‚çš„ç¥ç»å…ƒæ ¹æ®ç½‘ç»œçš„ä»»åŠ¡ï¼ˆå›å½’ã€åˆ†ç±»ç­‰ï¼‰ç”Ÿæˆæœ€ç»ˆçš„é¢„æµ‹ç»“æœ</li>
<li><strong>éšè—å±‚ï¼ˆHidden Layersï¼‰</strong>:
è¾“å…¥å±‚å’Œè¾“å‡ºå±‚ä¹‹é—´éƒ½æ˜¯éšè—å±‚ï¼Œç¥ç»ç½‘ç»œçš„â€œæ·±åº¦â€é€šå¸¸ç”±éšè—å±‚çš„æ•°é‡å†³å®š</li>
</ul>
<p>ç›¸é‚»å±‚çš„ç¥ç»å…ƒç›¸äº’è¿æ¥ï¼Œç§°ä¸º<strong>å…¨è¿æ¥ï¼ˆFully
Connectedï¼‰</strong>ï¼Œå…¨è¿æ¥ç¥ç»ç½‘ç»œæ¥æ”¶çš„æ ·æœ¬æ•°æ®æ˜¯<strong>äºŒç»´çš„</strong>ï¼Œæ•°æ®åœ¨æ¯ä¸€å±‚ä¹‹é—´éœ€è¦ä»¥äºŒç»´çš„å½¢å¼ä¼ é€’ã€‚æ¯ä¸ªè¿æ¥éƒ½ä¼šæœ‰ä¸€ä¸ªæƒé‡ï¼Œç¥ç»å…ƒçš„ä¿¡æ¯é€å±‚ä¼ é€’ç§°ä¸º<strong>å‰å‘ä¼ æ’­ï¼ˆforwardï¼‰</strong>ï¼Œä¸Šä¸€å±‚çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥ã€‚</p>
<p><img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-nn_inner.png" srcset="/img/loading.gif" lazyload /></p>
<p>æ¯ä¸ªç¥ç»å…ƒåœ¨å‰å‘ä¼ æ’­æ—¶ä¿å­˜<em>å†…éƒ¨çŠ¶æ€å€¼ï¼ˆåŠ æƒæ±‚å’Œå€¼ï¼‰</em>å’Œ<em>æ¿€æ´»å€¼</em>ï¼Œåœ¨åå‘ä¼ æ’­æ—¶è®¡ç®—å¹¶ä¿å­˜çš„<em>æ¿€æ´»å€¼æ¢¯åº¦</em>å’Œ<em>å†…éƒ¨çŠ¶æ€å€¼æ¢¯åº¦</em>ã€‚</p>
<ul>
<li>å‰å‘ä¼ æ’­
<ul>
<li>å†…éƒ¨çŠ¶æ€å€¼ï¼š<span
class="math inline"><em>ğ‘§</em>â€„=â€„<em>ğ‘¤</em>â€…â‹…â€…<em>ğ‘¥</em>â€…+â€…<em>ğ‘</em></span></li>
<li>æ¿€æ´»å€¼ï¼š<span
class="math inline"><em>ğ‘</em>â€„=â€„<em>ğ‘“</em>(<em>ğ‘§</em>)</span></li>
</ul></li>
<li>åå‘ä¼ æ’­
<ul>
<li>æ¿€æ´»å€¼æ¢¯åº¦ï¼šæŸå¤±å‡½æ•°å¯¹æ¿€æ´»å€¼çš„åå¯¼ <span
class="math inline">$\frac{\partial L}{\partial a}$</span></li>
<li>å†…éƒ¨çŠ¶æ€å€¼æ¢¯åº¦ï¼šæ¿€æ´»å€¼æ¢¯åº¦ Ã— æ¿€æ´»å‡½æ•°å¯¼æ•° <span
class="math inline">$\frac{\partial L}{\partial z}=\frac{\partial
L}{\partial a} Â· f^{\prime}(z)$</span></li>
</ul></li>
</ul>
<h1 id="æ¿€æ´»å‡½æ•°">2 æ¿€æ´»å‡½æ•°</h1>
<p>å¦‚æœæ²¡æœ‰æ¿€æ´»å‡½æ•°ï¼Œæ— è®ºåŠ å…¥å¤šå°‘éšè—å±‚ï¼Œæ•´ä¸ªç¥ç»ç½‘ç»œéƒ½ç­‰æ•ˆäºå•å±‚çº¿æ€§å˜æ¢ã€‚æ¿€æ´»å‡½æ•°ä¸ºç¥ç»ç½‘ç»œå¼•å…¥äº†éçº¿æ€§ï¼Œä½¿å¾—ç¥ç»ç½‘ç»œèƒ½å¤Ÿå­¦ä¹ å’Œè¡¨ç¤ºå¤æ‚çš„éçº¿æ€§å…³ç³»ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://playground.tensorflow.org/">å¯è§†åŒ–ç¥ç»ç½‘ç»œ</a></p>
<h2 id="é˜¶è·ƒå‡½æ•°">2.1 é˜¶è·ƒå‡½æ•°</h2>
<p>é˜¶è·ƒå‡½æ•°æ˜¯åœ¨æ„ŸçŸ¥æœºä¸­æœ€ç®€å•çš„æ¿€æ´»å‡½æ•°ï¼Œå¯ä»¥ä¸ºè¾“å…¥è®¾ç½®ä¸€ä¸ªé˜ˆå€¼ï¼›ä¸€æ—¦è¶…è¿‡è¿™ä¸ªé˜ˆå€¼ï¼Œå°±åˆ‡æ¢è¾“å‡ºï¼ˆ0
æˆ–è€…
1ï¼‰ã€‚é˜¶è·ƒå‡½æ•°åœ¨0ç‚¹ä¸å¯å¯¼ï¼Œå¹¶ä¸”åœ¨å…¶ä»–ç‚¹å¯¼æ•°ä¸º0ï¼Œå› æ­¤æ— æ³•è¿›è¡Œæ¢¯åº¦ä¸‹é™ã€‚</p>
<p><span class="math display">$$f(x)=\left\{
\begin{array}
{c}0,x&lt;0 \\
1, x\geq0
\end{array}\right. ,\quad f^{\prime}(x)=0$$</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> np.array(x &gt; <span class="hljs-number">0</span>, dtype=np.int32)<br><br>x = np.arange(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0.1</span>)<br>plt.plot(x, step(x))<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">[&lt;matplotlib.lines.Line2D at 0x176df26e0&gt;]</code></pre>
<figure>
<img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-02_ç¥ç»ç½‘ç»œåŸºç¡€_14_1.png" srcset="/img/loading.gif" lazyload
alt="png" />
<figcaption aria-hidden="true">png</figcaption>
</figure>
<h2 id="sigmoidå‡½æ•°">2.2 Sigmoidå‡½æ•°</h2>
<p>Sigmoidï¼ˆä¹Ÿå« Logistic
å‡½æ•°ï¼‰æ˜¯å¹³æ»‘å¯å¾®çš„ï¼Œèƒ½å°†ä»»æ„è¾“å…¥æ˜ å°„åˆ°åŒºé—´(0,1)ã€‚å› å…¶æ¶‰åŠæŒ‡æ•°è¿ç®—ï¼Œè®¡ç®—é‡ç›¸å¯¹è¾ƒé«˜ã€‚</p>
<p><span class="math display">$$f(x)=\frac{1}{1+e^{-x} } ,\quad
f^{\prime}(x)=\frac{1}{1+e^{-x} }\left(1-\frac{1}{1+e^{-x}
}\right)=f(x)\left(1-f(x)\right)$$</span></p>
<p>Sigmoid çš„å¯¼æ•°èŒƒå›´æ˜¯(0, 0.25]ï¼Œæ¢¯åº¦è¾ƒå°ï¼Œå¹¶ä¸”è¾“å…¥åœ¨ [-6, 6]
ä¹‹å¤–çš„è¾“å‡ºå€¼å˜åŒ–å¾ˆå°ï¼Œæ­¤æ—¶ç½‘ç»œå‚æ•°æ›´æ–°æå…¶ç¼“æ…¢ï¼Œç”šè‡³æ— æ³•æ›´æ–°ã€‚</p>
<p>Sigmoid ä¸€èˆ¬åœ¨ 5
å±‚ä¹‹å†…å°±ä¼šå‡ºç°æ¢¯åº¦æ¶ˆå¤±çš„æƒ…å†µï¼Œå¹¶ä¸”ç”±äºè¯¥å‡½æ•°ä¸æ˜¯ä»¥0ä¸ºä¸­å¿ƒçš„ï¼Œæ¿€æ´»å€¼æ€»æ˜¯æ­£æ•°ï¼Œåœ¨æ¢¯åº¦æ›´æ–°æ—¶åªå¯¹æŸäº›ç‰¹å¾äº§ç”Ÿç›¸åŒæ–¹å‘çš„å½±å“ã€‚ä¸€èˆ¬åªç”¨åœ¨<strong>äºŒåˆ†ç±»çš„è¾“å‡ºå±‚</strong>æˆ–è€…å±‚æ•°è¾ƒå°‘çš„ç¥ç»ç½‘ç»œã€‚</p>
<p>Sigmoid åœ¨äºŒåˆ†ç±»çš„è¾“å‡ºå±‚ï¼Œè¾“å‡ºä¸º 1 ä¸ªèŠ‚ç‚¹ï¼Œç›´æ¥è¡¨ç¤ºæ ·æœ¬å±äºç±»åˆ« 1
çš„æ¦‚ç‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_sigmoid</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> / (<span class="hljs-number">1</span> + np.exp(-x))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sigmoid_prime</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> my_sigmoid(x) * (<span class="hljs-number">1</span> - my_sigmoid(x))<br><br>_, axs = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">5</span>))<br>x = np.arange(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0.1</span>)<br><br>axs[<span class="hljs-number">0</span>].plot(x, my_sigmoid(x))<br>axs[<span class="hljs-number">0</span>].set_title(<span class="hljs-string">&quot;Sigmoid(x)&quot;</span>)<br>axs[<span class="hljs-number">1</span>].plot(x, sigmoid_prime(x))<br>axs[<span class="hljs-number">1</span>].set_title(<span class="hljs-string">&quot;Sigmoid&#x27;(x)&quot;</span>)<br><br>axs[<span class="hljs-number">0</span>].axhline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)  <span class="hljs-comment"># x è½´</span><br>axs[<span class="hljs-number">0</span>].axvline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)  <span class="hljs-comment"># y è½´</span><br>axs[<span class="hljs-number">1</span>].axhline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>axs[<span class="hljs-number">1</span>].axvline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">&lt;matplotlib.lines.Line2D at 0x177a2ccd0&gt;</code></pre>
<figure>
<img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-02_ç¥ç»ç½‘ç»œåŸºç¡€_17_1.png" srcset="/img/loading.gif" lazyload
alt="png" />
<figcaption aria-hidden="true">png</figcaption>
</figure>
<h2 id="tanhå‡½æ•°">2.3 Tanhå‡½æ•°</h2>
<p>ä¸Šé¢è¯´åˆ° Sigmoid ä¸ä»¥ 0 å€¼ä¸ºä¸­å¿ƒï¼Œå¹¶ä¸”å¯¼æ•°å€¼æ¯”è¾ƒå°ï¼ŒTanh å°±æ˜¯å¯¹
Sigmoid çš„æ”¹è¿›ï¼Œè¿›è¡Œç¼©æ”¾å’Œåç§»ï¼Œä½¿å…¶ä»¥ 0 å€¼ä¸ºä¸­å¿ƒï¼Œå¹¶ä¸”å¯¼æ•°å€¼æ¥è¿‘
1ã€‚</p>
<p><span class="math display">$$f(x)=\frac{2}{1+e^{-2x}
}-1=\frac{2}{1+e^{-2x} }+\frac{-1-e^{-2x} }{1+e^{-2x} }=\frac{1-e^{-2x}
}{1+e^{-2x} }$$</span></p>
<p><span class="math display">$$f^{\prime}(x)=1-\left(\frac{1-e^{-2x}
}{1+e^{-2x} }\right)^{2}=1-f^{2}(x)$$</span></p>
<p>Tanh åœ¨ [-3, 3] ä¹‹å¤–çš„è¾“å‡ºå€¼å˜åŒ–ä¹Ÿå¾ˆå°ï¼Œä¸ Sigmoid ç›¸æ¯”ï¼ŒTanh ä»¥ 0
ä¸ºä¸­å¿ƒï¼Œå¹¶ä¸”æ¢¯åº¦å€¼æ›´å¤§ï¼Œæ‰€ä»¥æ”¶æ•›é€Ÿåº¦æ›´å¿«ï¼Œä½†åŒæ ·å­˜åœ¨æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ã€‚å¯ä»¥<strong>åœ¨éšè—å±‚ä¸­ä½¿ç”¨
Tanhï¼Œåœ¨è¾“å‡ºå±‚ä¸­ä½¿ç”¨ Sigmoid</strong>ã€‚</p>
<blockquote>
<p><span class="math inline">$\frac{2}{1+e^{-2x} }-1$</span> æ˜¯ Sigmoid
çš„å˜å½¢ï¼Œ2 å€çš„ Sigmoid å°† y è½´ æ”¾å¤§ 1 å€ï¼Œ 2x å°† x è½´ç¼©æ”¾ 1å€ï¼Œå† -1 å°†
y è½´å¹³ç§»åˆ° (-1, 1) åŒºé—´å†…ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_tanh</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> np.tanh(x)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">tanh_prime</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> - np.tanh(x) ** <span class="hljs-number">2</span><br><br>_, axs = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">5</span>))<br>x = np.arange(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0.1</span>)<br><br>axs[<span class="hljs-number">0</span>].plot(x, my_tanh(x))<br>axs[<span class="hljs-number">0</span>].set_title(<span class="hljs-string">&quot;Tanh(x)&quot;</span>)<br>axs[<span class="hljs-number">1</span>].plot(x, tanh_prime(x))<br>axs[<span class="hljs-number">1</span>].set_title(<span class="hljs-string">&quot;Tanh&#x27;(x)&quot;</span>)<br><br>axs[<span class="hljs-number">0</span>].axhline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>axs[<span class="hljs-number">0</span>].axvline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>axs[<span class="hljs-number">1</span>].axhline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>axs[<span class="hljs-number">1</span>].axvline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">&lt;matplotlib.lines.Line2D at 0x177a99150&gt;</code></pre>
<figure>
<img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-02_ç¥ç»ç½‘ç»œåŸºç¡€_20_1.png" srcset="/img/loading.gif" lazyload
alt="png" />
<figcaption aria-hidden="true">png</figcaption>
</figure>
<h2 id="reluå‡½æ•°">2.4 ReLUå‡½æ•°</h2>
<p>ReLUï¼ˆRectified Linear Unitï¼Œä¿®æ­£çº¿æ€§å•å…ƒï¼‰ä¼šå°†å°äºç­‰äº 0
çš„è¾“å…¥è½¬æ¢ä¸º 0ï¼Œå¤§äº 0 çš„è¾“å…¥åˆ™ä¿æŒä¸å˜ã€‚ReLu
æ›´åŠ é‡è§†æ­£ä¿¡å·ï¼Œè€Œå¿½ç•¥è´Ÿä¿¡å·ã€‚</p>
<p><span class="math display">$$
f ( x )=\left\{ {\begin{array} {l} {0, x \leq0} \\ {x, x &gt; 0}
\end{array} } ,\quad \right. f^{\prime} ( x )=\left\{ {\begin{array} {l}
{0, x \leq0} \\ {1, x &gt; 0} \end{array} } \right.
$$</span></p>
<p>ReLU åœ¨å¤§äº 0 æ—¶ï¼Œå¯¼æ•°ä¸€ç›´ä¸º 1ï¼Œä¸å­˜åœ¨æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ã€‚ä½†åœ¨è¾“å…¥å°äº 0
æ—¶ï¼Œè¾“å‡ºä¸º 0ï¼ŒReLu
åªä¼šæ¿€æ´»éƒ¨åˆ†ç¥ç»å…ƒï¼Œè¿™ç§ç¨€ç–æ€§æœ‰åŠ©äºå‡å°‘è®¡ç®—é‡æé«˜æ•ˆç‡ï¼Œå¹¶ä¸”å¯ä»¥ç¼“è§£è¿‡æ‹Ÿåˆçš„å‘ç”Ÿã€‚ä½†å¦‚æœéƒ¨åˆ†è¾“å…¥ä¸€ç›´å°äº0ï¼Œè¾“å‡ºä¸€ç›´ä¸º0ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´å¦ä¸€ä¸ªé—®é¢˜ï¼Œå³<strong>ç¥ç»å…ƒæ­»äº¡</strong>ï¼Œå¦‚æœå¤§é‡çš„ç¥ç»å…ƒæ­»äº¡ï¼Œä¼šå½±å“æ¨¡å‹çš„å­¦ä¹ èƒ½åŠ›ã€‚</p>
<p>ReLu
è®¡ç®—ç®€å•ï¼Œä¸å­˜åœ¨æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç½‘ç»œç¨€ç–ï¼Œ<strong>å¸¸ç”¨äºéšè—å±‚</strong>ï¼Œé€‚ç”¨äºæ·±å±‚ç¥ç»ç½‘ç»œã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_relu</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> np.maximum(<span class="hljs-number">0</span>, x)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">relu_prime</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1.0</span> * (x &gt; <span class="hljs-number">0</span>)<br><br>_, axs = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">5</span>))<br>x = np.arange(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0.1</span>)<br><br>axs[<span class="hljs-number">0</span>].plot(x, my_relu(x))<br>axs[<span class="hljs-number">0</span>].set_title(<span class="hljs-string">&quot;ReLU(x)&quot;</span>)<br>axs[<span class="hljs-number">1</span>].plot(x, relu_prime(x))<br>axs[<span class="hljs-number">1</span>].set_title(<span class="hljs-string">&quot;ReLU&#x27;(x)&quot;</span>)<br><br>axs[<span class="hljs-number">0</span>].axhline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>axs[<span class="hljs-number">0</span>].axvline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>axs[<span class="hljs-number">1</span>].axhline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>axs[<span class="hljs-number">1</span>].axvline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">&lt;matplotlib.lines.Line2D at 0x177c517b0&gt;</code></pre>
<figure>
<img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-02_ç¥ç»ç½‘ç»œåŸºç¡€_23_1.png" srcset="/img/loading.gif" lazyload
alt="png" />
<figcaption aria-hidden="true">png</figcaption>
</figure>
<h2 id="leaky-reluå‡½æ•°">2.5 Leaky ReLUå‡½æ•°</h2>
<p>ä¸ºäº†è§£å†³ ReLu çš„ç¥ç»å…ƒæ­»äº¡é—®é¢˜ï¼Œå¼•å…¥äº† Leaky ReLu
æ¿€æ´»å‡½æ•°ï¼Œåœ¨è¾“å…¥ä¸ºè´Ÿçš„æ—¶å€™å¼•å…¥ä¸€ä¸ªå¾ˆå°çš„æ–œç‡ï¼Œä»è€Œé¿å…ç¥ç»å…ƒæ­»äº¡ã€‚</p>
<p><span class="math display">$$
f ( x )=\left\{ {\begin{array} {l} {\alpha x, x \leq0} \\ {x, x &gt; 0}
\end{array} },\quad \right. f^{\prime} ( x )=\left\{ {\begin{array} {l}
{\alpha, x \leq0} \\ {1, x &gt; 0} \end{array} } \right.
$$</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_leaky_relu</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> np.maximum(<span class="hljs-number">0.05</span> * x, x)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">leaky_relu_prime</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> np.where(x &gt; <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0.05</span>)<br><br>_, axs = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">12</span>, <span class="hljs-number">5</span>))<br>x = np.arange(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0.1</span>)<br><br>axs[<span class="hljs-number">0</span>].plot(x, my_leaky_relu(x))<br>axs[<span class="hljs-number">0</span>].set_title(<span class="hljs-string">&quot;Leaky ReLU(x)&quot;</span>)<br>axs[<span class="hljs-number">1</span>].plot(x, leaky_relu_prime(x))<br>axs[<span class="hljs-number">1</span>].set_title(<span class="hljs-string">&quot;Leaky ReLU&#x27;(x)&quot;</span>)<br><br>axs[<span class="hljs-number">0</span>].axhline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>axs[<span class="hljs-number">0</span>].axvline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>axs[<span class="hljs-number">1</span>].axhline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>axs[<span class="hljs-number">1</span>].axvline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">&lt;matplotlib.lines.Line2D at 0x177d371c0&gt;</code></pre>
<figure>
<img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-02_ç¥ç»ç½‘ç»œåŸºç¡€_26_1.png" srcset="/img/loading.gif" lazyload
alt="png" />
<figcaption aria-hidden="true">png</figcaption>
</figure>
<h2 id="softmaxå‡½æ•°">2.6 Softmaxå‡½æ•°</h2>
<p>Softmax å°†ä¸€ä¸ªä»»æ„çš„å®æ•°å‘é‡è½¬æ¢ä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œç¡®ä¿è¾“å‡ºå€¼çš„æ€»å’Œä¸º
1,æ˜¯äºŒåˆ†ç±»æ¿€æ´»å‡½æ•° Sigmoid
åœ¨å¤šåˆ†ç±»ä¸Šçš„æ¨å¹¿ã€‚<strong>å¸¸ç”¨äºå¤šåˆ†ç±»é—®é¢˜çš„è¾“å‡ºå±‚</strong>ï¼Œç”¨æ¥è¡¨ç¤ºç±»åˆ«çš„è¾“å‡ºæ¦‚ç‡ã€‚</p>
<p><span class="math display">$$
y_{k}={\frac{e^{x_{k} } } {\sum_{i=1}^{n} e^{x_{i} } } }, \quad k=1
{\sim} n
\qquad\qquad
\frac{\partial y_{k} } {\partial x_{i} }=\left\{\begin{matrix} {y_{k} (
1-y_{i} ), k=i} \\ {-y_{k} y_{i}, k \neq i} \\ \end{matrix} \right.
$$</span></p>
<p>Softmax
ä¼šæ”¾å¤§è¾“å…¥ä¸­è¾ƒå¤§çš„å€¼ï¼Œä½¿å¾—æœ€å¤§è¾“å…¥å€¼å¯¹åº”çš„è¾“å‡ºæ¦‚ç‡è¾ƒå¤§ï¼Œå…¶ä»–è¾ƒå°çš„å€¼ä¼šè¢«å‹ç¼©ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_softmax</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> np.exp(x) / np.<span class="hljs-built_in">sum</span>(np.exp(x), axis=<span class="hljs-number">1</span>).reshape(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br><br>x = np.array([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]])<br><br>_, axs = plt.subplots(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, figsize=(<span class="hljs-number">10</span>, <span class="hljs-number">8</span>))<br>axs[<span class="hljs-number">0</span>].pie(my_softmax(x)[<span class="hljs-number">0</span>], labels=x[<span class="hljs-number">0</span>])<br>axs[<span class="hljs-number">1</span>].pie(my_softmax(x)[<span class="hljs-number">1</span>], labels=x[<span class="hljs-number">0</span>])<br><br><span class="hljs-comment"># æ¯ä¸ªåˆ†ç±»çš„æ¦‚ç‡  </span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;\t1\t2\t3\t4\t5\n&#x27;</span>,np.char.add(np.<span class="hljs-built_in">round</span>(my_softmax(x) * <span class="hljs-number">100</span>, <span class="hljs-number">2</span>).astype(<span class="hljs-built_in">str</span>), <span class="hljs-string">&#x27;%&#x27;</span>))<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">    1   2   3   4   5
 [[&#39;1.17%&#39; &#39;3.17%&#39; &#39;8.61%&#39; &#39;23.41%&#39; &#39;63.64%&#39;]
 [&#39;0.62%&#39; &#39;92.46%&#39; &#39;0.62%&#39; &#39;1.69%&#39; &#39;4.6%&#39;]]</code></pre>
<figure>
<img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-02_ç¥ç»ç½‘ç»œåŸºç¡€_29_1.png" srcset="/img/loading.gif" lazyload
alt="png" />
<figcaption aria-hidden="true">png</figcaption>
</figure>
<h2 id="å…¶ä»–æ¿€æ´»å‡½æ•°">2.7 å…¶ä»–æ¿€æ´»å‡½æ•°</h2>
<h3 id="identityæ’ç­‰å‡½æ•°">2.7.1 Identityæ’ç­‰å‡½æ•°</h3>
<p>Identity å‡½æ•°éå¸¸ç®€å•ï¼Œå®ƒè¿”å›è¾“å…¥å€¼æœ¬èº«ï¼Œé€‚ç”¨äºå›å½’ä»»åŠ¡çš„è¾“å‡ºã€‚</p>
<p><span
class="math display"><em>f</em>(<em>x</em>)â€„=â€„<em>x</em>,â€Šâ€<em>f</em><sup>â€²</sup>(<em>x</em>)â€„=â€„1</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">x = np.array([-<span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>])<br>plt.plot(x, x)<br><br>plt.axhline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>plt.axvline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>plt.title(<span class="hljs-string">&#x27;Identity&#x27;</span>)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">Text(0.5, 1.0, &#39;Identity&#39;)</code></pre>
<figure>
<img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-02_ç¥ç»ç½‘ç»œåŸºç¡€_33_1.png" srcset="/img/loading.gif" lazyload
alt="png" />
<figcaption aria-hidden="true">png</figcaption>
</figure>
<h3 id="preluå‡½æ•°">2.7.2 PReLUå‡½æ•°</h3>
<p>PReLUï¼ˆParametric Rectified Linear Unitï¼‰ä¸­çš„ Î±
æ˜¯ä¸€ä¸ªå¯è®­ç»ƒçš„å‚æ•°ï¼Œè€Œä¸æ˜¯å›ºå®šå¸¸æ•°ã€‚</p>
<p><span class="math display">$$
f ( x )=\left\{ {\begin{array} {l} {\alpha x, x \leq0} \\ {x, x &gt; 0}
\end{array} },\quad \right. f^{\prime} ( x )=\left\{ {\begin{array} {l}
{\alpha, x \leq0} \\ {1, x &gt; 0} \end{array} } \right.
$$</span></p>
<h3 id="rreluå‡½æ•°">2.7.3 RReLUå‡½æ•°</h3>
<p>RReLUï¼ˆRandomized Leaky ReLUï¼‰ä¸­çš„ Î±
æ˜¯ä»å‡åŒ€åˆ†å¸ƒä¸­éšæœºé€‰æ‹©çš„ä¸€ä¸ªå€¼ï¼ŒèŒƒå›´æ˜¯ [0, 1]ã€‚</p>
<p><span class="math display">$$
f ( x )=\left\{ {\begin{array} {l} {\alpha x, x \leq0} \\ {x, x &gt; 0}
\end{array} },\quad \right. f^{\prime} ( x )=\left\{ {\begin{array} {l}
{\alpha, x \leq0} \\ {1, x &gt; 0} \end{array} } \right.
$$</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rrelu</span>(<span class="hljs-params">x, alpha=<span class="hljs-number">0.01</span></span>):<br>    <span class="hljs-keyword">return</span> np.where(x &gt; <span class="hljs-number">0</span>, x, alpha * x)<br><br>x = np.arange(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0.1</span>)<br>plt.plot(x, rrelu(x))<br>plt.fill_between(x, rrelu(x, alpha=<span class="hljs-number">0.1</span>), rrelu(x, alpha=<span class="hljs-number">0.5</span>), where=(x &lt; <span class="hljs-number">0</span>), color=<span class="hljs-string">&#x27;navy&#x27;</span>, alpha=<span class="hljs-number">0.5</span>)<br><br>plt.axhline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>plt.axvline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>plt.title(<span class="hljs-string">&#x27;RReLU&#x27;</span>)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">Text(0.5, 1.0, &#39;RReLU&#39;)</code></pre>
<figure>
<img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-02_ç¥ç»ç½‘ç»œåŸºç¡€_38_1.png" srcset="/img/loading.gif" lazyload
alt="png" />
<figcaption aria-hidden="true">png</figcaption>
</figure>
<h3 id="eluå‡½æ•°">2.7.4 ELUå‡½æ•°</h3>
<p>ELUï¼ˆExponential Linear Unitï¼‰æ˜¯åœ¨è´Ÿè½´ä¸Šæ›´åŠ å¹³æ»‘çš„ReLUå‡½æ•°ã€‚</p>
<p><span class="math display">$$
f ( x )=\left\{\begin{array} {c} { {\alpha( e^{x}-1 ), x \leq0} } \\ {
{x, x &gt; 0} } \end{array} \right.,\quad \ f^{\prime} ( x
)=\left\{\begin{array} {c} { {\alpha e^{x}, x \leq0} } \\ { {1, x &gt;
0} } \end{array} \right.
$$</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">elu</span>(<span class="hljs-params">x, alpha=<span class="hljs-number">0.01</span></span>):<br>    <span class="hljs-keyword">return</span> np.where(x &gt; <span class="hljs-number">0</span>, x, alpha * (np.exp(x) - <span class="hljs-number">1</span>))<br><br>x = np.arange(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0.1</span>)<br>plt.plot(x, elu(x, alpha=<span class="hljs-number">1</span>))<br><br>plt.axhline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>plt.axvline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>plt.title(<span class="hljs-string">&#x27;ELU&#x27;</span>)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">Text(0.5, 1.0, &#39;ELU&#39;)</code></pre>
<figure>
<img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-02_ç¥ç»ç½‘ç»œåŸºç¡€_41_1.png" srcset="/img/loading.gif" lazyload
alt="png" />
<figcaption aria-hidden="true">png</figcaption>
</figure>
<h3 id="swishå‡½æ•°">2.7.5 Swishå‡½æ•°</h3>
<p>Swishï¼Œä¹Ÿç§°Sigmoid Linear Unitï¼ŒSiLUå‡½æ•°ã€‚</p>
<p><span class="math display">$$
f ( x )=\frac{x} {1+e^{-x} } ,\quad f^{\prime( x )}=\frac{1+e^{-x}+x
e^{-x} } {( 1+e^{-x} )^{2} }
$$</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">swish</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> x * my_sigmoid(x)<br><br>x = np.arange(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0.1</span>)<br>plt.plot(x, swish(x))<br><br>plt.axhline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>plt.axvline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>plt.title(<span class="hljs-string">&#x27;Swish&#x27;</span>)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">Text(0.5, 1.0, &#39;Swish&#39;)</code></pre>
<figure>
<img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-02_ç¥ç»ç½‘ç»œåŸºç¡€_44_1.png" srcset="/img/loading.gif" lazyload
alt="png" />
<figcaption aria-hidden="true">png</figcaption>
</figure>
<h3 id="softpluså‡½æ•°">2.7.6 Softpluså‡½æ•°</h3>
<p><span class="math display">$$
f ( x )=\ln( 1+e^{x} ) ,\quad f^{\prime( x )}=\frac{1} {1+e^{-x} }
$$</span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">softplus</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> np.log(<span class="hljs-number">1</span> + np.exp(x))<br><br>x = np.arange(-<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0.1</span>)<br>plt.plot(x, softplus(x))<br><br>plt.axhline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>plt.axvline(c=<span class="hljs-string">&#x27;gray&#x27;</span>, ls=<span class="hljs-string">&#x27;--&#x27;</span>)<br>plt.title(<span class="hljs-string">&#x27;Softplus&#x27;</span>)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">Text(0.5, 1.0, &#39;Softplus&#39;)</code></pre>
<figure>
<img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-02_ç¥ç»ç½‘ç»œåŸºç¡€_47_1.png" srcset="/img/loading.gif" lazyload
alt="png" />
<figcaption aria-hidden="true">png</figcaption>
</figure>
<h2 id="æ¿€æ´»å‡½æ•°çš„é€‰æ‹©">2.8 æ¿€æ´»å‡½æ•°çš„é€‰æ‹©</h2>
<ul>
<li><strong>éšè—å±‚</strong>
<ul>
<li>é¦–é€‰ ReLU å‡½æ•°ï¼Œå¦‚æœæ•ˆæœä¸å¥½å¯å°è¯• Leaky ReLU ç­‰å‡½æ•°</li>
<li>Tanh çš„è¾“å‡ºå‡å€¼ä¸º
0ï¼Œå¯¹ä¸­å¿ƒåŒ–æ•°æ®æ›´å‹å¥½ï¼Œä½†å¯èƒ½å‡ºç°æ¢¯åº¦æ¶ˆå¤±ï¼Œä»…é€‚ç”¨äºæµ…å±‚ç½‘ç»œ</li>
<li>Sigmoid åœ¨éšè—å±‚å®¹æ˜“å¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ï¼Œä»…é€‚ç”¨äºæµ…å±‚ç½‘ç»œ</li>
</ul></li>
<li><strong>è¾“å‡ºå±‚</strong>
<ul>
<li>äºŒåˆ†ç±»é€‰æ‹© Sigmoid</li>
<li>å¤šåˆ†ç±»é€‰æ‹© Softmax</li>
<li>å›å½’é€‰æ‹© Identity</li>
</ul></li>
</ul>
<h2 id="api-å®ç°">2.9 API å®ç°</h2>
<ul>
<li><code>Sigmoid</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn<br><br>torch.manual_seed(<span class="hljs-number">66</span>)<br>x = torch.randn(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)<br><br><span class="hljs-comment"># å‡½æ•°å¼å†™æ³•ï¼Œæ–¹ä¾¿ç›´æ¥è®¡ç®—</span><br>z = torch.sigmoid(x)<br><br><span class="hljs-comment"># æ¨¡å—å†™æ³•ï¼Œéœ€è¦å…ˆåˆ›å»ºå¯¹è±¡ï¼Œæ–¹ä¾¿ç®¡ç†æ¨¡å‹</span><br>sigmoid = nn.Sigmoid()<br>z = sigmoid(x)<br></code></pre></td></tr></table></figure>
<ul>
<li><code>Tanh</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">tanh = nn.Tanh()<br>tanh(x)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">tensor([[ 0.9497, -0.2163,  0.3297],
        [-0.9473,  0.1161,  0.8130]])</code></pre>
<ul>
<li><code>ReLU</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">relu = nn.ReLU()<br>relu(x)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">tensor([[1.8289, 0.0000, 0.3424],
        [0.0000, 0.1166, 1.1357]])</code></pre>
<ul>
<li><code>Leaky ReLU</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">leaky_relu = nn.LeakyReLU(negative_slope=<span class="hljs-number">0.1</span>)<br>leaky_relu(x)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">tensor([[ 1.8289, -0.0220,  0.3424],
        [-0.1805,  0.1166,  1.1357]])</code></pre>
<ul>
<li><code>Softmax</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">softmax = nn.Softmax(dim=-<span class="hljs-number">1</span>)  <span class="hljs-comment"># dim ä¸º -1 ï¼Œè¡¨ç¤ºæœ€åä¸€ç»´è¿›è¡Œå½’ä¸€åŒ–ï¼Œè¿™é‡Œä¹Ÿå°±æ˜¯åˆ—</span><br>softmax(x)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">tensor([[0.7380, 0.0951, 0.1669],
        [0.0374, 0.2553, 0.7073]])</code></pre>
<p>å…¶ä»–æ¿€æ´»å‡½æ•°åœ¨ <code>nn</code> ä¸­ä¹Ÿæœ‰å¯¹åº”æ¨¡å—ï¼Œä¸å†ä¸€ä¸€æ¼”ç¤ºã€‚</p>
<h1 id="ç¥ç»ç½‘ç»œç®€å•å®ç°">3 ç¥ç»ç½‘ç»œç®€å•å®ç°</h1>
<p>æ·±åº¦ç¥ç»ç½‘ç»œç”±å¤šä¸ªå±‚ï¼ˆlayerï¼‰ç»„æˆï¼Œé€šå¸¸å°†å…¶ç§°ä¹‹ä¸ºæ¨¡å‹ï¼ˆModelï¼‰ã€‚æ•´ä¸ªæ¨¡å‹æ¥æ”¶åŸå§‹è¾“å…¥ï¼ˆç‰¹å¾ï¼‰ï¼Œç”Ÿæˆè¾“å‡ºï¼ˆé¢„æµ‹ï¼‰ï¼Œå¹¶åŒ…å«ä¸€äº›å‚æ•°ã€‚ä¸‹å›¾æ˜¯ä¸€ä¸ªä¸‰å±‚ç¥ç»ç½‘ç»œï¼Œæƒé‡å’Œç¥ç»å…ƒçš„ä¸Šæ ‡
<span class="math inline"><sup>(1)</sup></span> è¡¨ç¤ºç½‘ç»œå±‚å·ï¼Œä¸‹æ ‡ <span
class="math inline"><sub>21</sub></span>
åˆ†åˆ«ä»£è¡¨è¾“å…¥ç¥ç»å…ƒç¼–å·å’Œè¾“å‡ºç¥ç»å…ƒç¼–å·ã€‚</p>
<p>è¾“å…¥å±‚-&gt;ç¬¬1å±‚ï¼Œä½¿ç”¨çŸ©é˜µä¹˜æ³•è¡¨ç¤ºï¼š</p>
<p><span
class="math display"><em>A</em><sup>(1)</sup>â€„=â€„<em>X</em><em>W</em><sup>(1)</sup>â€…+â€…<em>B</em><sup>(1)</sup></span></p>
<p>å…¶ä¸­</p>
<p><span class="math display">$$
A^{( 1 )}=( a_{1}^{( 1 )} \; a_{2}^{( 1 )} \; a_{3}^{( 1 )}), \quad X=(
x_{1} \, \, x_{2} ), \quad B^{( 1 )}=( b_{1}^{( 1 )} \, \, \, b_{2}^{( 1
)} \, \, \, b_{3}^{( 1 )}), \quad
W^{( 1 )}=\left( \begin{matrix} { {w_{1 1}^{( 1 )} } } &amp; { {w_{1
2}^{( 1 )} } } &amp; { {w_{1 3}^{( 1 )} } } \\ { {w_{2 1}^{( 1 )} } }
&amp; { {w_{2 2}^{( 1 )} } } &amp; { {w_{2 3}^{( 1 )} } } \end{matrix}
\right)
$$</span></p>
<p>è®¡ç®—å¾—åˆ°çš„ <span class="math inline"><em>A</em><sup>(1)</sup></span>
å†ç»è¿‡æ¿€æ´»å‡½æ•° <span class="math inline"><em>h</em>()</span> å¾—åˆ° <span
class="math inline"><em>Z</em><sup>(1)</sup></span>ï¼Œç»§ç»­ä½œä¸ºç¬¬1å±‚-&gt;ç¬¬2å±‚çš„è¾“å…¥ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<p><img
src="https://img.zhubaoduo.com/02_ç¥ç»ç½‘ç»œåŸºç¡€-nn_signal.png" srcset="/img/loading.gif" lazyload /></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><br><span class="hljs-comment"># åˆå§‹åŒ–æƒé‡å’Œåç½®</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">init_network</span>():<br>    network = &#123;&#125;<br>    network[<span class="hljs-string">&#x27;W1&#x27;</span>] = np.random.randn(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)<br>    network[<span class="hljs-string">&#x27;b1&#x27;</span>] = np.random.randn(<span class="hljs-number">3</span>)<br>    network[<span class="hljs-string">&#x27;W2&#x27;</span>] = np.random.randn(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>)<br>    network[<span class="hljs-string">&#x27;b2&#x27;</span>] = np.random.randn(<span class="hljs-number">2</span>)<br>    network[<span class="hljs-string">&#x27;W3&#x27;</span>] = np.random.randn(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>)<br>    network[<span class="hljs-string">&#x27;b3&#x27;</span>] = np.random.randn(<span class="hljs-number">2</span>)<br>    <br>    <span class="hljs-keyword">return</span> network<br><br><br><span class="hljs-comment"># å‰å‘ä¼ æ’­</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">network, x</span>):<br>    w1, w2, w3 = network[<span class="hljs-string">&#x27;W1&#x27;</span>], network[<span class="hljs-string">&#x27;W2&#x27;</span>], network[<span class="hljs-string">&#x27;W3&#x27;</span>]<br>    b1, b2, b3 = network[<span class="hljs-string">&#x27;b1&#x27;</span>], network[<span class="hljs-string">&#x27;b2&#x27;</span>], network[<span class="hljs-string">&#x27;b3&#x27;</span>]<br>    <br>    a1 = x @ w1 + b1  <span class="hljs-comment"># ç¬¬ 1 å±‚åŠ æƒæ±‚å’Œå€¼</span><br>    z1 = my_tanh(a1)  <span class="hljs-comment"># ç¬¬ 1 å±‚ç»è¿‡æ¿€æ´»å‡½æ•°</span><br>    a2 = z1 @ w2 + b2  <span class="hljs-comment"># ç¬¬ 2 å±‚åŠ æƒæ±‚å’Œå€¼</span><br>    z2 = my_relu(a2)  <span class="hljs-comment"># ç¬¬ 2 å±‚ç»è¿‡æ¿€æ´»å‡½æ•°</span><br>    a3 = z2 @ w3 + b3  <span class="hljs-comment"># ç¬¬ 3 å±‚åŠ æƒæ±‚å’Œå€¼</span><br>    y = my_sigmoid(a3)  <span class="hljs-comment"># ç¬¬ 3 å±‚ç»è¿‡æ¿€æ´»å‡½æ•°è¾“å‡º</span><br>    <br>    <span class="hljs-keyword">return</span> y<br><br><br>net = init_network()<br>X = np.array([<span class="hljs-number">4</span>, <span class="hljs-number">2</span>])<br>y = forward(net, X)<br><span class="hljs-built_in">print</span>(y)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">[0.88363004 0.34900234]</code></pre>
<h1 id="å‚æ•°åˆå§‹åŒ–">4 å‚æ•°åˆå§‹åŒ–</h1>
<p>ç¥ç»ç½‘ç»œä¸­çš„å‚æ•°æ˜¯éœ€è¦åˆå§‹åŒ–ï¼Œå‚æ•°åˆå§‹åŒ–çš„ä½œç”¨ï¼š</p>
<ul>
<li><strong>é˜²æ­¢æ¢¯åº¦æ¶ˆå¤±æˆ–çˆ†ç‚¸</strong>ï¼šåˆå§‹æƒé‡å€¼è¿‡å¤§æˆ–è¿‡å°ä¼šå¯¼è‡´æ¢¯åº¦åœ¨åå‘ä¼ æ’­ä¸­æŒ‡æ•°çº§å¢å¤§æˆ–ç¼©å°ã€‚</li>
<li><strong>æé«˜æ”¶æ•›é€Ÿåº¦</strong>ï¼šåˆç†çš„åˆå§‹åŒ–ä½¿å¾—ç½‘ç»œçš„æ¿€æ´»å€¼åˆ†å¸ƒé€‚ä¸­ï¼Œæœ‰åŠ©äºæ¢¯åº¦é«˜æ•ˆæ›´æ–°ã€‚</li>
<li><strong>ä¿æŒå¯¹ç§°æ€§ç ´é™¤</strong>ï¼šæƒé‡çš„åˆå§‹åŒ–éœ€è¦æ‰“ç ´å¯¹ç§°æ€§ï¼Œå¦åˆ™ç½‘ç»œçš„å­¦ä¹ èƒ½åŠ›ä¼šå—åˆ°é™åˆ¶ã€‚ï¼ˆå¯¹ç§°æ€§æŒ‡æƒé‡çš„å€¼ç›¸åŒï¼Œç¥ç»å…ƒçš„åŠŸèƒ½æ²¡æœ‰å·®å¼‚ï¼‰</li>
</ul>
<h2 id="å¸¸æ•°åˆå§‹åŒ–">4.1 å¸¸æ•°åˆå§‹åŒ–</h2>
<p>æ— æ³•æ‰“ç ´å¯¹ç§°æ€§ï¼Œåå‘ä¼ æ’­æ—¶å…¨éƒ¨éƒ½ä¼šè¿›è¡Œç›¸åŒçš„æ›´æ–°ï¼Œä½¿å¾—ç½‘ç»œå¤±å»äº†ä¸åŒç¥ç»å…ƒçš„æ„ä¹‰ï¼Œæ— æ³•æœ‰æ•ˆè®­ç»ƒã€‚é€šå¸¸åªä¼šä½¿ç”¨å…¨
0 åˆå§‹åŒ–åç½®ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn<br><br>linear = nn.Linear(<span class="hljs-number">5</span>, <span class="hljs-number">2</span>)<br><br><span class="hljs-comment"># æ‰€æœ‰å‚æ•°åˆå§‹åŒ–ä¸º 0</span><br>nn.init.zeros_(linear.weight)<br><span class="hljs-built_in">print</span>(linear.weight)<br><br><span class="hljs-comment"># æ‰€æœ‰å‚æ•°åˆå§‹åŒ–ä¸º 1</span><br>nn.init.ones_(linear.weight)<br><span class="hljs-built_in">print</span>(linear.weight)<br><br><span class="hljs-comment"># æ‰€æœ‰å‚æ•°åˆå§‹åŒ–ä¸ºå›ºå®šå¸¸æ•°</span><br>nn.init.constant_(linear.weight, <span class="hljs-number">66</span>)<br><span class="hljs-built_in">print</span>(linear.weight)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">Parameter containing:
tensor([[0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0.]], requires_grad=True)
Parameter containing:
tensor([[1., 1., 1., 1., 1.],
        [1., 1., 1., 1., 1.]], requires_grad=True)
Parameter containing:
tensor([[66., 66., 66., 66., 66.],
        [66., 66., 66., 66., 66.]], requires_grad=True)</code></pre>
<h2 id="ç§©åˆå§‹åŒ–">4.2 ç§©åˆå§‹åŒ–</h2>
<p>æƒé‡å‚æ•°åˆå§‹åŒ–ä¸ºå•ä½çŸ©é˜µã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">nn.init.eye_(linear.weight)<br><span class="hljs-built_in">print</span>(linear.weight)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">Parameter containing:
tensor([[1., 0., 0., 0., 0.],
        [0., 1., 0., 0., 0.]], requires_grad=True)</code></pre>
<h2 id="éšæœºåˆå§‹åŒ–">4.3 éšæœºåˆå§‹åŒ–</h2>
<p>å‡åŒ€åˆ†å¸ƒåˆå§‹åŒ–ï¼šä»åŒºé—´ä¸­å‡åŒ€éšæœºå–å€¼ï¼Œé»˜è®¤åŒºé—´ä¸ºï¼ˆ0ï¼Œ1ï¼‰ï¼Œå¯ä»¥è®¾ä¸º
$(-ï¼Œ) $ï¼Œå…¶ä¸­ d ä¸ºç¥ç»å…ƒçš„è¾“å…¥æ•°é‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">nn.init.uniform_(linear.weight)<br><span class="hljs-built_in">print</span>(linear.weight)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">Parameter containing:
tensor([[0.4520, 0.7268, 0.0245, 0.7780, 0.5695],
        [0.9082, 0.2932, 0.1449, 0.6995, 0.1598]], requires_grad=True)</code></pre>
<p>æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–ï¼šä»å‡å€¼ä¸º 0ï¼Œæ ‡å‡†å·®ä¸º 1
çš„é«˜æ–¯åˆ†å¸ƒä¸­å–æ ·ï¼Œä½¿ç”¨ä¸€äº›å¾ˆå°çš„å€¼è¿›è¡Œåˆå§‹åŒ–ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">nn.init.normal_(linear.weight)<br><span class="hljs-built_in">print</span>(linear.weight)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">Parameter containing:
tensor([[ 1.0646,  0.6571, -1.7206, -0.5381, -1.1052],
        [-0.4689,  1.1999, -1.7586,  0.9557, -0.8140]], requires_grad=True)</code></pre>
<h2 id="xavieråˆå§‹åŒ–">4.4 Xavieråˆå§‹åŒ–</h2>
<p>Xavier åˆå§‹åŒ–ï¼Œä¹Ÿå« Glorot
åˆå§‹åŒ–ï¼Œè®¾è®¡æ€æƒ³æ˜¯è®©æ¯å±‚çš„è¾“å…¥æ–¹å·®å’Œè¾“å‡ºæ–¹å·®ä¸€è‡´ï¼Œä¿æŒä¿¡å·åœ¨æ¯ä¸€å±‚ä¼ æ’­æ—¶ä¸è¡°å‡ã€ä¸æ”¾å¤§ã€‚å¸¸ç”¨äº
Sigmoid å’Œ Tanh æ¿€æ´»å‡½æ•°ï¼Œä¸æ¨èç”¨äº ReLU æ¿€æ´»å‡½æ•°ã€‚</p>
<ul>
<li><p>Xavier å‡åŒ€åˆ†å¸ƒåˆå§‹åŒ–ï¼š<span
class="math inline">$\left[-{\sqrt{\frac{6} {n_{i n}+n_{o u t} } } },
{\sqrt{\frac{6} {n_{i n}+n_{o u t} } } } \right]$</span></p></li>
<li><p>Xavier æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–ï¼šå‡å€¼ä¸º 0ï¼Œå‡å€¼ä¸º <span
class="math inline">${\sqrt{\frac{2} {n_{i n}+n_{o u t} } }
}$</span></p></li>
</ul>
<p>å…¶ä¸­ <span
class="math inline"><em>n</em><sub><em>i</em><em>n</em></sub></span>
è¡¨ç¤ºè¾“å…¥ç¥ç»å…ƒçš„æ•°é‡ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€å±‚ç¥ç»å…ƒçš„æ•°é‡ï¼Œ<span
class="math inline"><em>n</em><sub><em>o</em><em>u</em><em>t</em></sub></span>
æ˜¯è¾“å‡ºç¥ç»å…ƒçš„æ•°é‡ï¼Œä¹Ÿå°±æ˜¯ä¸‹ä¸€å±‚ç¥ç»å…ƒçš„æ•°é‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Xavier å‡åŒ€åˆ†å¸ƒåˆå§‹åŒ–</span><br>nn.init.xavier_uniform_(linear.weight)<br><span class="hljs-built_in">print</span>(linear.weight)<br><br><span class="hljs-comment"># Xavier æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–</span><br>nn.init.xavier_normal_(linear.weight)<br><span class="hljs-built_in">print</span>(linear.weight)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">Parameter containing:
tensor([[ 0.2802,  0.8988, -0.1018,  0.4321, -0.4568],
        [-0.2845,  0.3657, -0.7230, -0.2094,  0.9017]], requires_grad=True)
Parameter containing:
tensor([[ 0.2160, -0.9007, -0.3396, -0.4396,  0.2919],
        [-0.0365, -0.2839, -0.6361, -0.3293,  0.3296]], requires_grad=True)</code></pre>
<h2 id="kaimingåˆå§‹åŒ–">4.5 Kaimingåˆå§‹åŒ–</h2>
<p>Kaiming åˆå§‹åŒ–ï¼Œä¹Ÿå« He åˆå§‹åŒ–ï¼Œè€ƒè™‘åˆ° ReLU ä¼šæŠŠä¸€åŠçš„ç¥ç»å…ƒè¾“å‡ºè®¾ä¸º
0ï¼Œå› æ­¤éœ€è¦æ›´å¤§çš„æ–¹å·®æ¥ç»´æŒä¿¡å·å¹…åº¦ã€‚å¸¸ç”¨äº ReLu å’Œ Leaky
ReLUï¼Œä¸æ¨èç”¨äº Sigmoidã€‚</p>
<ul>
<li><p>Kaiming å‡åŒ€åˆ†å¸ƒåˆå§‹åŒ–ï¼š<span
class="math inline">$\left[-{\sqrt{\frac{6} {n_{i n} } } },
{\sqrt{\frac{6} {n_{i n} } } } \right]$</span></p></li>
<li><p>Kaiming æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–ï¼šå‡å€¼ä¸º 0ï¼Œå‡å€¼ä¸º <span
class="math inline">${\sqrt{\frac{2} {n_{i n} } } }$</span></p></li>
</ul>
<p>å…¶ä¸­ <span
class="math inline"><em>n</em><sub><em>i</em><em>n</em></sub></span>
è¡¨ç¤ºè¾“å…¥ç¥ç»å…ƒçš„æ•°é‡ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€å±‚ç¥ç»å…ƒçš„æ•°é‡ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Kaiming å‡åŒ€åˆ†å¸ƒåˆå§‹åŒ–</span><br>nn.init.kaiming_uniform_(linear.weight)<br><span class="hljs-built_in">print</span>(linear.weight)<br><br><span class="hljs-comment"># Kaiming æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–</span><br>nn.init.kaiming_normal_(linear.weight)<br><span class="hljs-built_in">print</span>(linear.weight)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">Parameter containing:
tensor([[ 0.7357, -0.4194,  0.6922, -0.8139, -1.0905],
        [-0.2551, -0.3574,  0.3759,  0.9959,  0.1350]], requires_grad=True)
Parameter containing:
tensor([[ 0.3897,  0.4593,  1.3781, -0.0915,  0.3848],
        [ 0.3878, -0.3613,  0.7376, -0.3496, -0.1828]], requires_grad=True)</code></pre>
<h1 id="æ­å»ºç¥ç»ç½‘ç»œ">5 æ­å»ºç¥ç»ç½‘ç»œ</h1>
<h2 id="è‡ªå®šä¹‰ç½‘ç»œ">5.1 è‡ªå®šä¹‰ç½‘ç»œ</h2>
<p>åœ¨ç¥ç»ç½‘ç»œæ¡†æ¶ä¸­ï¼Œç”±å¤šä¸ªå±‚ç»„æˆçš„ç»„ä»¶ç§°ä¹‹ä¸ºæ¨¡å—ï¼ˆModuleï¼‰ï¼Œåœ¨ PyTorch
ä¸­ Module æ˜¯æ‰€æœ‰ç¥ç»ç½‘ç»œçš„åŸºç±»ã€‚å®šä¹‰ Module
æ—¶éœ€è¦ç»§æ‰¿<code>nn.Module</code>ï¼Œå¹¶ä¸»è¦é‡å†™ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li><code>__init__</code>ï¼šå®šä¹‰ç½‘ç»œä¸­çš„å±‚ç»“æ„ï¼Œå¹¶è§†æƒ…å†µè¿›è¡Œåˆå§‹åŒ–ã€‚</li>
<li><code>forward</code>ï¼šæ ¹æ®è¾“å…¥è¿›è¡Œå‰å‘ä¼ æ’­ï¼Œå¹¶è¿”å›è¾“å‡ºã€‚åœ¨è°ƒç”¨ç¥ç»ç½‘ç»œæ¨¡å‹å¯¹è±¡çš„æ—¶å€™ï¼Œåº•å±‚ä¼šè‡ªåŠ¨è°ƒç”¨è¯¥å‡½æ•°ã€‚</li>
</ul>
<p>ä¸‹é¢ç¥ç»ç½‘ç»œè®¾è®¡å¦‚ä¸‹ï¼š</p>
<ol type="1">
<li>è¾“å…¥å±‚ï¼šè¾“å…¥å±‚æœ‰4ä¸ªèŠ‚ç‚¹ï¼Œå¯¹åº”è¾“å…¥æ•°æ®çš„4ä¸ªç‰¹å¾</li>
<li>ç¬¬1éšè—å±‚ï¼šæœ‰3ä¸ªèŠ‚ç‚¹ï¼Œä½¿ç”¨ Xavier æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–æƒé‡ï¼Œæ¿€æ´»å‡½æ•°ä½¿ç”¨
Tanh</li>
<li>ç¬¬2éšè—å±‚ï¼šæœ‰2ä¸ªèŠ‚ç‚¹ï¼Œä½¿ç”¨ Kaiming æ­£æ€åˆ†å¸ƒåˆå§‹åŒ–æƒé‡ï¼Œæ¿€æ´»å‡½æ•°ä½¿ç”¨
ReLU</li>
<li>è¾“å‡ºå±‚ï¼šæœ‰ 3
ä¸ªèŠ‚ç‚¹ï¼ŒæŒ‰é»˜è®¤æ–¹å¼ï¼ˆPyTorché»˜è®¤å‡åŒ€éšæœºåˆ†å¸ƒï¼‰è¿›è¡Œåˆå§‹åŒ–ï¼Œæ¿€æ´»å‡½æ•°ä½¿ç”¨
Softmax</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch <br><span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Model</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>().__init__()  <span class="hljs-comment"># è°ƒç”¨çˆ¶ç±»åˆå§‹åŒ–</span><br>        <br>        <span class="hljs-variable language_">self</span>.fc1 = nn.Linear(<span class="hljs-number">4</span>, <span class="hljs-number">3</span>)  <span class="hljs-comment"># ç¬¬1å±‚åˆå§‹åŒ–ï¼Œ4ä¸ªè¾“å…¥ï¼Œ3ä¸ªè¾“å‡º</span><br>        <span class="hljs-variable language_">self</span>.fc2 = nn.Linear(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>)  <span class="hljs-comment"># ç¬¬2å±‚åˆå§‹åŒ–ï¼Œ3ä¸ªè¾“å…¥ï¼Œ2ä¸ªè¾“å‡º</span><br>        <span class="hljs-variable language_">self</span>.out = nn.Linear(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)  <span class="hljs-comment"># è¾“å‡ºå±‚ï¼Œ2ä¸ªè¾“å…¥ï¼Œ3ä¸ªè¾“å‡º</span><br>        <br>        <span class="hljs-comment"># æ¿€æ´»å‡½æ•°</span><br>        <span class="hljs-variable language_">self</span>.relu = nn.ReLU()<br>        <span class="hljs-variable language_">self</span>.tanh = nn.Tanh()<br>        <br>        <span class="hljs-comment"># åˆå§‹åŒ–æƒé‡</span><br>        nn.init.xavier_normal_(<span class="hljs-variable language_">self</span>.fc1.weight) <br>        nn.init.kaiming_normal_(<span class="hljs-variable language_">self</span>.fc2.weight) <br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):<br>        x = <span class="hljs-variable language_">self</span>.fc1(x)  <span class="hljs-comment"># ç»è¿‡ç¬¬ 1 ä¸ªéšè—å±‚</span><br>        x = <span class="hljs-variable language_">self</span>.tanh(x)  <span class="hljs-comment"># ç¬¬ 1 å±‚æ¿€æ´»å‡½æ•°</span><br>        x = <span class="hljs-variable language_">self</span>.fc2(x)  <span class="hljs-comment"># ç»è¿‡ç¬¬ 2 ä¸ªéšè—å±‚</span><br>        x = torch.relu(x)  <span class="hljs-comment"># ç¬¬ 2 å±‚æ¿€æ´»å‡½æ•°</span><br>        x = <span class="hljs-variable language_">self</span>.out(x)  <span class="hljs-comment"># ç»è¿‡è¾“å‡ºå±‚</span><br>        <span class="hljs-comment"># softmax çš„ dim æŒ‡å®šå½’ä¸€åŒ–çš„ç»´åº¦ï¼Œæ­¤å¤„å¯ä»¥ä½¿ç”¨ 1 è¡¨ç¤ºå¯¹æ¯ä¸€è¡Œåšå½’ä¸€åŒ–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ -1 æ›´åŠ é€šç”¨åœ°è¡¨ç¤ºæœ€åä¸€ç»´</span><br>        x = torch.softmax(x, dim=-<span class="hljs-number">1</span>)  <span class="hljs-comment"># æ¿€æ´»å‡½æ•°</span><br>        <br>        <span class="hljs-keyword">return</span> x<br>    <br>model = Model()<br>X = torch.randn(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>)<br>y_pred = model(X)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;é¢„æµ‹å€¼ï¼š\n&#x27;</span>, y_pred)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;é¢„æµ‹æ ‡ç­¾ï¼š\n&#x27;</span>, torch.argmax(y_pred, dim=<span class="hljs-number">1</span>).detach().numpy())<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">é¢„æµ‹å€¼ï¼š
 tensor([[0.2632, 0.3978, 0.3391],
        [0.2272, 0.3991, 0.3737],
        [0.2632, 0.3978, 0.3391],
        [0.2632, 0.3978, 0.3391],
        [0.2632, 0.3978, 0.3391],
        [0.2342, 0.3991, 0.3667]], grad_fn=&lt;SoftmaxBackward0&gt;)
é¢„æµ‹æ ‡ç­¾ï¼š
 [1 1 1 1 1 1]</code></pre>
<h2 id="æŸ¥çœ‹æ¨¡å‹å‚æ•°">5.2 æŸ¥çœ‹æ¨¡å‹å‚æ•°</h2>
<p>ä½¿ç”¨ <code>named_parameters()</code>
æŸ¥çœ‹å„å±‚å‚æ•°ï¼Œé€šå¸¸è¿­ä»£å’Œè®¿é—®æ‰€æœ‰å¯è®­ç»ƒå‚æ•°ï¼ˆrequires_grad=Trueï¼‰ä¾›æ¢¯åº¦æ›´æ–°ä½¿ç”¨ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> name, param <span class="hljs-keyword">in</span> model.named_parameters():<br>    <span class="hljs-built_in">print</span>(name, param, <span class="hljs-string">&#x27;\n&#x27;</span>)<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">fc1.weight Parameter containing:
tensor([[-1.0289, -0.0880,  0.8888, -0.6779],
        [-0.3527, -0.1030, -0.1152, -0.0459],
        [-0.2099, -0.1153,  0.2160, -0.9007]], requires_grad=True) 

fc1.bias Parameter containing:
tensor([-0.0480,  0.2268, -0.4755], requires_grad=True) 

fc2.weight Parameter containing:
tensor([[-0.5187, -0.6714,  0.4459],
        [-0.0557, -0.4336, -0.9717]], requires_grad=True) 

fc2.bias Parameter containing:
tensor([-0.3928, -0.5646], requires_grad=True) 

out.weight Parameter containing:
tensor([[-0.1984, -0.6112],
        [-0.5136, -0.2566],
        [-0.0660, -0.0348]], requires_grad=True) 

out.bias Parameter containing:
tensor([0.0401, 0.4532, 0.2935], requires_grad=True) </code></pre>
<p>ä½¿ç”¨ <code>state_dict</code>
æŸ¥çœ‹å„å±‚å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå­—å…¸ï¼Œå¸¸ç”¨äºå­˜å‚¨å’ŒåŠ è½½æ¨¡å‹çš„æ‰€æœ‰çŠ¶æ€ï¼Œä¿å­˜æ£€æŸ¥ç‚¹å’Œéƒ¨ç½²ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">model.state_dict()<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">OrderedDict([(&#39;fc1.weight&#39;,
              tensor([[-1.0289, -0.0880,  0.8888, -0.6779],
                      [-0.3527, -0.1030, -0.1152, -0.0459],
                      [-0.2099, -0.1153,  0.2160, -0.9007]])),
             (&#39;fc1.bias&#39;, tensor([-0.0480,  0.2268, -0.4755])),
             (&#39;fc2.weight&#39;,
              tensor([[-0.5187, -0.6714,  0.4459],
                      [-0.0557, -0.4336, -0.9717]])),
             (&#39;fc2.bias&#39;, tensor([-0.3928, -0.5646])),
             (&#39;out.weight&#39;,
              tensor([[-0.1984, -0.6112],
                      [-0.5136, -0.2566],
                      [-0.0660, -0.0348]])),
             (&#39;out.bias&#39;, tensor([0.0401, 0.4532, 0.2935]))])</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ä¿å­˜æ¨¡å‹å‚æ•°</span><br>torch.save(model.state_dict(), <span class="hljs-string">&#x27;model/model.pth&#x27;</span>)<br><br><span class="hljs-comment"># åŠ è½½æ¨¡å‹å‚æ•°</span><br>model.load_state_dict(torch.load(<span class="hljs-string">&#x27;model/model.pth&#x27;</span>))<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">&lt;All keys matched successfully&gt;</code></pre>
<h2 id="æ¨¡å‹å‚æ•°å¯è§†åŒ–">5.3 æ¨¡å‹å‚æ•°å¯è§†åŒ–</h2>
<p><code>summary</code>
æ˜¯ä¸€ä¸ªæ¨¡å‹ç»“æ„å¯è§†åŒ–å·¥å…·ï¼Œå®ƒå¯ä»¥æ¸…æ™°åœ°æ¨¡å‹æ¯ä¸€å±‚çš„ï¼šå±‚åç§°ï¼ˆLayer
Typeï¼‰ã€è¾“å‡ºå¼ é‡å½¢çŠ¶ï¼ˆOutput
Shapeï¼‰ã€å‚æ•°æ•°é‡ï¼ˆParamsï¼‰ã€ä»¥åŠæ€»å‚æ•°é‡ç»Ÿè®¡ã€‚éœ€è¦ä½¿ç”¨
<code>pip install torchsummary</code> å®‰è£…ã€‚</p>
<p><code>summary</code> ä¼šè‡ªåŠ¨æ„é€ ä¸€ä¸ªè™šæ‹Ÿè¾“å…¥å¼ é‡ï¼Œä¼ å…¥æ¨¡å‹åšä¸€æ¬¡
<code>forward</code>ï¼Œç„¶åè®°å½•æ¯ä¸€å±‚çš„è¾“å…¥/è¾“å‡ºå½¢çŠ¶ã€å‚æ•°é‡ã€å ç”¨å†…å­˜ç­‰ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> torchsummary <span class="hljs-keyword">import</span> summary<br><br>summary(<br>        model = model,     <span class="hljs-comment"># æ¨¡å‹</span><br>        input_size=(<span class="hljs-number">4</span>, ),  <span class="hljs-comment"># è¡¨ç¤ºä¸€ä¸ªè¾“å…¥æ ·æœ¬çš„ç»´åº¦</span><br>        batch_size=<span class="hljs-number">16</span>,     <span class="hljs-comment"># æ‰¹æ¬¡å¤§å°</span><br>        device=<span class="hljs-string">&#x27;cpu&#x27;</span>       <span class="hljs-comment"># é»˜è®¤ä½¿ç”¨ GPUï¼ŒPyTorch ä¸å…è®¸CPUå’ŒGPUæ··åˆè¿ç®—ï¼Œæˆ–è€…å¯ä»¥å°†æ¨¡å‹å’Œæ•°æ® to(&#x27;cuda&#x27;)</span><br>        )<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Linear-1                    [16, 3]              15
              Tanh-2                    [16, 3]               0
            Linear-3                    [16, 2]               8
            Linear-4                    [16, 3]               9
================================================================
Total params: 32
Trainable params: 32
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.00
Estimated Total Size (MB): 0.00
----------------------------------------------------------------</code></pre>
<p>å¦å¤–ä¹Ÿå¯ä»¥ä½¿ç”¨<code>torchinfo.summary()</code>ï¼Œåªéœ€è¦<code>model</code>å’Œ<code>input_size</code>ä½œä¸ºå‚æ•°ä¼ å…¥å³å¯ï¼Œæ›´åŠ æ–¹ä¾¿ã€‚ä½¿ç”¨<code>pip install torchinfo</code>å®‰è£…ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> torchinfo <span class="hljs-keyword">import</span> summary<br><br>inputs = torch.randn(<span class="hljs-number">16</span>, <span class="hljs-number">4</span>)<br><br>summary(<br>    model=model, <br>    input_size=(<span class="hljs-number">16</span>, <span class="hljs-number">4</span>),  <span class="hljs-comment"># è¾“å…¥æ•°æ®çš„å¤§å°</span><br>    <span class="hljs-comment"># input_data=inputs, # ä¹Ÿå¯ä»¥ä½¿ç”¨è¾“å…¥æ•°æ®</span><br>    <span class="hljs-comment"># batch_dim=0,       # æŒ‡å®šæ‰¹æ¬¡çš„ç»´åº¦ç´¢å¼•</span><br>    verbose=<span class="hljs-number">2</span>,           <span class="hljs-comment"># æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯  </span><br>    )<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Model                                    [16, 3]                   --
â”œâ”€Linear: 1-1                            [16, 3]                   15
â”‚    â””â”€weight                                                      â”œâ”€12
â”‚    â””â”€bias                                                        â””â”€3
â”œâ”€Tanh: 1-2                              [16, 3]                   --
â”œâ”€Linear: 1-3                            [16, 2]                   8
â”‚    â””â”€weight                                                      â”œâ”€6
â”‚    â””â”€bias                                                        â””â”€2
â”œâ”€Linear: 1-4                            [16, 3]                   9
â”‚    â””â”€weight                                                      â”œâ”€6
â”‚    â””â”€bias                                                        â””â”€3
==========================================================================================
Total params: 32
Trainable params: 32
Non-trainable params: 0
Total mult-adds (Units.MEGABYTES): 0.00
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.00
Estimated Total Size (MB): 0.00
==========================================================================================





==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Model                                    [16, 3]                   --
â”œâ”€Linear: 1-1                            [16, 3]                   15
â”‚    â””â”€weight                                                      â”œâ”€12
â”‚    â””â”€bias                                                        â””â”€3
â”œâ”€Tanh: 1-2                              [16, 3]                   --
â”œâ”€Linear: 1-3                            [16, 2]                   8
â”‚    â””â”€weight                                                      â”œâ”€6
â”‚    â””â”€bias                                                        â””â”€2
â”œâ”€Linear: 1-4                            [16, 3]                   9
â”‚    â””â”€weight                                                      â”œâ”€6
â”‚    â””â”€bias                                                        â””â”€3
==========================================================================================
Total params: 32
Trainable params: 32
Non-trainable params: 0
Total mult-adds (Units.MEGABYTES): 0.00
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.00
Params size (MB): 0.00
Estimated Total Size (MB): 0.00
==========================================================================================</code></pre>
<h2 id="é¡ºåºç½‘ç»œ">5.4 é¡ºåºç½‘ç»œ</h2>
<p>ä½¿ç”¨ <code>nn.Sequential</code>
æ„å»ºçš„ç½‘ç»œï¼Œå„å±‚æŒ‰ç…§æ·»åŠ çš„é¡ºåºé€å±‚è¿æ¥ï¼Œå…¶ä¸­æ¯ä¸€å±‚çš„è¾“å‡ºç›´æ¥ä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥ã€‚æ„å»ºéå¸¸ç®€å•ï¼Œä½†é™åˆ¶äº†ç½‘ç»œçš„å¤æ‚æ€§ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">model = nn.Sequential(<br>    nn.Linear(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>),<br>    nn.Tanh(),<br>    nn.Linear(<span class="hljs-number">4</span>, <span class="hljs-number">8</span>),<br>    nn.ReLU(),<br>    nn.Linear(<span class="hljs-number">8</span>, <span class="hljs-number">3</span>),<br>    nn.Softmax(dim=-<span class="hljs-number">1</span>)<br>)<br><br><span class="hljs-comment"># å¦‚æœéœ€è¦åˆå§‹åŒ–å‚æ•°ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹ä»£ç </span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">init_params</span>(<span class="hljs-params">m</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(m) == nn.Linear:<br>        nn.init.kaiming_normal_(m.weight)<br>        nn.init.zeros_(m.bias)<br><br><span class="hljs-comment"># apply ä¼šéå†æ‰€æœ‰å­æ¨¡å—ä¾æ¬¡è°ƒç”¨æ­¤å‡½æ•°</span><br>model.apply(init_params)<br><br>model(torch.rand(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>))<br></code></pre></td></tr></table></figure>
<pre><code class="hljs">tensor([[0.5799, 0.2505, 0.1696],
        [0.4363, 0.3862, 0.1775]], grad_fn=&lt;SoftmaxBackward0&gt;)</code></pre>
<h1 id="ç¥ç»ç½‘ç»œçš„æœ¬è´¨">6 ç¥ç»ç½‘ç»œçš„æœ¬è´¨</h1>
<p>åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œæ¯ä¸€å±‚éƒ½å¯ä»¥çœ‹ä½œæ˜¯å¯¹è¾“å…¥ç‰¹å¾çš„<strong>æŠ½è±¡ä¸å˜æ¢</strong>ã€‚</p>
<p>å‡è®¾æœ‰ 10 ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬æœ‰ 5 ä¸ªç‰¹å¾ï¼Œå³è¾“å…¥çŸ©é˜µçš„å½¢çŠ¶æ˜¯ (10,
5)ã€‚</p>
<ol type="1">
<li>ç¬¬ä¸€éšè—å±‚æœ‰ 10 ä¸ªç¥ç»å…ƒï¼Œå¯¹åº”æƒé‡çŸ©é˜µçš„å½¢çŠ¶æ˜¯ (5, 10)ã€‚</li>
</ol>
<p>è¾“å…¥ä¸æƒé‡ç›¸ä¹˜åå¾—åˆ°è¾“å‡ºçŸ©é˜µ (10, 10)ï¼Œä¹Ÿå°±æ˜¯æ¨¡å‹å°†åŸæ¥çš„ 5
ç»´ç‰¹å¾æŠ½è±¡æˆäº†æ–°çš„ 10 ç»´ç‰¹å¾è¡¨ç¤ºã€‚</p>
<ol start="2" type="1">
<li>ç¬¬äºŒéšè—å±‚æœ‰ 4 ä¸ªç¥ç»å…ƒï¼Œæƒé‡çŸ©é˜µä¸º (10, 4)ã€‚</li>
</ol>
<p>ä¸Šä¸€å±‚è¾“å‡º (10, 10) ä¹˜ä»¥ (10, 4)ï¼Œå¾—åˆ°æ–°çš„è¡¨ç¤º (10,
4)ï¼Œç›¸å½“äºæ¨¡å‹è¿›ä¸€æ­¥æç‚¼å‡ºäº† 4 ç»´æŠ½è±¡ç‰¹å¾ã€‚</p>
<ol start="3" type="1">
<li>è¾“å‡ºå±‚æœ‰ 3 ä¸ªç¥ç»å…ƒï¼Œå¯¹åº”æƒé‡çŸ©é˜µ (4, 3)ã€‚</li>
</ol>
<p>(10, 4) @ (4, 3) = (10, 3)ï¼Œè¡¨ç¤ºæ¨¡å‹ä¸ºæ¯ä¸ªæ ·æœ¬ç”Ÿæˆäº† 3 ä¸ªè¾“å‡ºå€¼ï¼Œå¯¹åº”
3 ä¸ªç±»åˆ«çš„æœªå½’ä¸€åŒ–å¾—åˆ†ï¼ˆlogitsï¼‰ã€‚</p>
<ol start="4" type="1">
<li>æœ€åé€šè¿‡ softmax æ¿€æ´»å‡½æ•°ï¼Œå¾—åˆ° 10 è¡Œ 10 ä¸ªæ ·æœ¬ï¼Œæ¯ä¸€è¡Œçš„ 3
ä¸ªå¾—åˆ†è½¬åŒ–ä¸ºæ¦‚ç‡åˆ†å¸ƒï¼Œå³æ¯ä¸ªæ ·æœ¬å±äº 3 ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œå½¢çŠ¶ä»æ˜¯ (10,
3)ã€‚</li>
</ol>
<p>å¯ä»¥çœ‹å‡ºï¼Œå…¨è¿æ¥å±‚ä¸­çš„çŸ©é˜µä¹˜æ³•ä¼šæ¶ˆæ‰è¿æ¥çš„ç»´åº¦ï¼Œä¿ç•™è¾“å…¥å±‚çš„<strong>æ‰¹æ¬¡ç»´åº¦æˆ–æ ·æœ¬å¤§å°</strong>ï¼Œä»¥åŠ<strong>è¾“å‡ºå±‚çš„ç¥ç»å…ƒèŠ‚ç‚¹æ•°</strong>ï¼Œæœ€ç»ˆçš„è¾“å‡ºå½¢çŠ¶ä¸ºï¼š</p>
<p><span
class="math display">æœ€ç»ˆè¾“å‡ºå½¢çŠ¶â€„=â€„æ‰¹æ¬¡å¤§å°â€…<em>o</em><em>r</em>â€…æ ·æœ¬å¤§å°â€…Ã—â€…è¾“å‡ºèŠ‚ç‚¹æ•°</span></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" class="category-chain-item">æ·±åº¦å­¦ä¹ </a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" class="print-no-link">#æ·±åº¦å­¦ä¹ </a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>02_ç¥ç»ç½‘ç»œåŸºç¡€</div>
      <div>http://example.com/2024/08/05/å¤§æ¨¡å‹å¼€å‘/05 æ·±åº¦å­¦ä¹ /02_ç¥ç»ç½‘ç»œåŸºç¡€/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>baoduozhu</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2024å¹´8æœˆ5æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/08/07/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91/05%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/03_%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0%E5%92%8C%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95/" title="03_æŸå¤±å‡½æ•°å’Œä¼˜åŒ–ç®—æ³•">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">03_æŸå¤±å‡½æ•°å’Œä¼˜åŒ–ç®—æ³•</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/08/03/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BC%80%E5%8F%91/05%20%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/01_%E5%BC%A0%E9%87%8F%E5%92%8C%E8%87%AA%E5%8A%A8%E5%BE%AE%E5%88%86/" title="01_å¼ é‡å’Œè‡ªåŠ¨å¾®åˆ†">
                        <span class="hidden-mobile">01_å¼ é‡å’Œè‡ªåŠ¨å¾®åˆ†</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
      <p>Â© 2025 æœ±å®é“ä¸ªäººæŠ€æœ¯ä¸“æ </p>
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        æ€»è®¿é—®é‡ 
        <span id="busuanzi_value_site_pv"></span>
         æ¬¡
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        æ€»è®¿å®¢æ•° 
        <span id="busuanzi_value_site_uv"></span>
         äºº
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
